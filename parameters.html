<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.1" />
<title>pipeline.parameters API documentation</title>
<meta name="description" content="Settings and configuration" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cse.google.com/cse.js?cx=017837193012385208679:pey8ky8gdqw"></script>
<style>.gsc-control-cse {padding:0 !important;margin-top:1em}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pipeline.parameters</code></h1>
</header>
<section id="section-intro">
<p>Settings and configuration</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/annotation/text-fabric/blob/190a380fa2c5889b9540f63bfd09e453e11bfcc6/pipeline/parameters.py#L0-L349" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;Settings and configuration
&#34;&#34;&#34;

from copy import deepcopy


COLORS = dict(
    blackGRS=0,
    blackRGB=(0, 0, 0),
    whiteGRS=255,
    whiteRGB=(255, 255, 255),
    marginGRS=255,
    marginRGB=(250, 250, 250),
    cleanRGB=(255, 255, 255),
    cleanhRGB=(220, 220, 220),
    boxDeleteRGB=(240, 170, 20),
    boxDeleteNRGB=(140, 70, 0),
    boxRemainRGB=(170, 240, 40),
    boxRemainNRGB=(70, 140, 0),
)
&#34;&#34;&#34;Named colors. &#34;&#34;&#34;


BAND_COLORS = dict(
    main=(40, 40, 40),
    inter=(255, 200, 200),
    broad=(0, 0, 255),
    high=(128, 128, 255),
    mid=(128, 255, 128),
    low=(255, 128, 128),
)
&#34;&#34;&#34;Band colors.

Each band will be displayed in its own color.
&#34;&#34;&#34;

STAGES = dict(
    orig=(&#34;image&#34;, None),
    gray=(&#34;image&#34;, None),
    rotated=(&#34;image&#34;, None),
    normalized=(&#34;image&#34;, None),
    normalizedC=(&#34;image&#34;, None),
    histogram=(&#34;image&#34;, None),
    demargined=(&#34;image&#34;, None),
    demarginedC=(&#34;image&#34;, None),
    markData=(&#34;data&#34;, &#34;yaml&#34;),
    boxed=(&#34;image&#34;, None),
    cleanh=(&#34;image&#34;, None),
    clean=(&#34;image&#34;, None),
    ocrData=(&#34;data&#34;, &#34;tsv&#34;),
)
&#34;&#34;&#34;Stages in page processing.

When we process a scanned page,
we produce named intermediate stages,
in this order.

The `...Data` stages are tab separated files with unicode data.
&#34;&#34;&#34;

SETTINGS = dict(
    inDir=&#34;in&#34;,
    outDir=&#34;out&#34;,
    interDir=&#34;inter&#34;,
    marksDir=&#34;marks&#34;,
    skewBorder=30,
    blurX=31,
    blurY=11,
    marginThresholdX=1,
    marginThresholdY=5,
    accuracy=0.8,
    connectBorder=4,
    connectThreshold=200 * 200,
    connectRatio=0.1,
    boxBorder=3,
    maxHits=5000,
    bandMain=(0, 0),
    bandInter=(5, 5),
    bandBroad=(-15, 10),
    bandMid=(10, -5),
    bandHigh=(10, 30),
    bandLow=(-10, -10),
)
&#34;&#34;&#34;Customizable settings.

These are the settings that can be customized
by calling the `Config` constructor and the
`Config.configure` method.

The default values can be inspected by expanding the source code.

inDir
:   name of the subdirectory with page scans

outDir
:   name of the subdirectory with the final results of the pipeline

interDir
:   name of the subdirectory with the intermediate results of the pipeline

marksDir
:   name of the subdirectory with the marks and dividers

skewBorder
:   the  width of the page  margins that will be whitened in order to
    suppress the sharp black triangles introduces by skewing the page

blurX
:   the amount of blur in the X-direction.
    Blurring is needed to get betterskewing and histograms

blurY
:   the amount of blur in the X-direction.
    Blurring is needed to get betterskewing and histograms.

    !!! caution &#34;Amount of Y-blurring&#34;
        Too much vertical blurring will cause the disappearance of horizontal
        bars from the histogram. Footnote  bars will go undetected.

        Too little vertical blurring will result in ragged histograms,
        from which it is difficult to get vertical line boundaries.

marginThresholdX, marginThresholdY
:   used when interpreting histograms.

    **Vertical lines**:

    The histogram for vertical lines will be chunked into groups,
    and only the biggest group will be retained.

    More precisely, values in the histogram for vertical lines that are below
    marginThresholdX will be considered 0. After that, the histogram points
    will be grouped into consecutive chunks with nonzero values.
    The biggest such group will have the vertical lines that contain the page material.
    All other vertical lines will be whitened.

    **Horizontal lines**:

    When histograms for horizontal lines cross marginThresholdY,  it will taken as an
    indication that a line boundary (upper or lower) has been reached.

    !!! hint &#34;Ragged histograms&#34;
        Histograms may be a bit ragged.

        When a histogram dives below the threshold, but jumps above it
        later, without having become zero in the meantime, the last such point
        will be taken as a lower boundary.

        When a histogram jumps above the threshold, but dives below it
        later, without touching zero, and then jumps above the threshold
        again, the latter point will *not* become the upper boundary.

accuracy
:   When marks are searched for in the page, we get the result in the form
    of a grayscale page where the value in each point reflects how much
    the page in that area resembles the mark.
    Only hits above the value of *accuracy* will be considered.

connectBorder
:   When marks are found, each hit will be inspected:
    is the ink in the hit connected to the ink outside the hit?
    This will be measured in an inner and outer border of the page,
    whose thickness is given by this parameter.

connectThreshold
:   After computing inner and outer borders,
    they will be inverted, so that black has the maximum
    value. Then the inside and outside borders are multiplied pixel wise,
    so that places where they are both black get very high values.
    All places where this product is higher than the value of *connectThreshold*
    are retained for further calculation.

connectRatio
:   After computing the places where inner and outer borders contain
    joint ink, the ratio of such places with respect to the total border size
    is calculated. If that ratio is greater than *connectRatio*,
    the hit counts as connected to its surroundings.
    We have not found a true instance of the mark, and the mark will not be cleaned.

boxBorder
:   The hits after searching for marks will be indicated on the `boxed` stage
    of the page by means of a small coloured border around each hit.
    The width of this border is *boxBorder*.

maxHits
:   When searching for marks, there are usually multiple hits: the place where
    the mark occurs, and some places very nearby.
    The cleaning algorithm will cluster nearby hits and pick the best
    hit per cluster.
    But if the number of hits is very large, it is a sign that the mark
    is not searched with the right accuracy, and clustering will be
    prevented. It would become very expensive, and useless anyway.
    A warning will be issued in such cases.

bandMain
:   Offsets for the `main` band. Given as `(top, bottom)`, with
    `top` and `bottom` positive or negative integers.

    This band covers most of the ink in a line.

    The `main` band is computed from the histogram after which the
    height of the top and bottom boundaries are adjusted relative to the
    values obtained by the histogram algorithm.

    You can adjust these values: higher values move the boundaries down,
    lower values move them up.

bandInter
:   Offsets for the `inter` band.

    This band covers most of the white between two lines.

    The `inter` band is computed from the histogram.

bandBroad
:   Offsets for the `broad` band.

    This band s like `main` but covers even more ink in a line.

bandMid
:   Offsets for the `mid` band.

    This band s like `main` but covers the densest part in a line.

bandHigh
:   Offsets for the `high` band.

    This band s like `inter` but covers the upper part of the letters and the white
    space above it.

bandLow
:   Offsets for the `low` band.

    This band s like `inter` but covers the lower part of the letters and the white
    space below it.
&#34;&#34;&#34;


class Config:
    def __init__(self, tm, **params):
        &#34;&#34;&#34;Settings manager.

        It will expose all settings as attributes to the rest
        of the application.

        It has methods to collect modified settings from the
        user and apply them.

        The default settings are kept as a separate copy that
        will not be changed in any way.

        User modifications act on the current settings,
        which have been obtained by deep-copying the defaults.

        Parameters
        ----------
        tm: object
            Can display timed info/error messages to the display
        params: dict
            key-value pairs that act as updates for the settings.
            If a value is `None`, the original value will be reinstated.
        &#34;&#34;&#34;

        self.tm = tm

        # colors are fixed
        for (k, v) in COLORS.items():
            setattr(self, k, v)

        # bands
        setattr(self, &#34;colorBand&#34;, BAND_COLORS)

        # stages
        setattr(self, &#34;stageOrder&#34;, tuple(STAGES))
        setattr(self, &#34;stages&#34;, STAGES)

        # settings
        self.settings = deepcopy(SETTINGS)

        # configure
        self.configure(reset=False, **params)

    def configure(self, reset=False, **params):
        &#34;&#34;&#34;Updates current settings based on new values.

        User modifications act on the current settings,
        which have been obtained by deep-copying the defaults.

        Parameters
        ----------
        reset: boolean, optional `False`
            If `True`, a fresh deep copy of the defaults will be made
            and that will be the basis for the new current settings.
        params: dict
            key-value pairs that act as updates for the settings.
            If a value is `None`, the original value will be reinstated.
        &#34;&#34;&#34;

        error = self.tm.error

        if reset:
            self.settings = deepcopy(SETTINGS)

        settings = self.settings

        for (k, v) in params.items():
            if k in SETTINGS:
                settings[k] = SETTINGS[k] if v is None else v
            else:
                error(f&#34;Unknown setting: {k}&#34;)

        # band offsets

        offsetBand = {}
        settings[&#34;offsetBand&#34;] = offsetBand

        for band in self.colorBand:
            bandOff = f&#34;band{band[0].upper()}{band[1:]}&#34;
            offsetBand[band] = settings[bandOff]

        # deliver as attributes

        for (k, v) in settings.items():
            if not k.startswith(&#34;band&#34;):
                setattr(self, k, v)

    def show(self, params=None):
        &#34;&#34;&#34;Display current settings.

        Parameters
        ----------
        params: str, optional `None`
            If `None`, all settings will be displayed.
            Else it should be a comma-separated string of legal
            parameter names whose values are to be displayed.
        &#34;&#34;&#34;
        tm = self.tm
        error = tm.error
        info = tm.info

        settings = self.settings

        params = sorted(set(params.split(&#39;,&#39;)) if params else settings)

        for k in params:
            if k in settings and k not in SETTINGS:
                continue
            if k not in SETTINGS:
                error(f&#34;No such setting: {k}&#34;, tm=False)
            info(f&#34;{k:&lt;20} = {settings[k]}&#34;, tm=False)</code></pre>
</details>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-variables">Global variables</h2>
<dl>
<dt id="pipeline.parameters.BAND_COLORS"><code class="name">var <span class="ident">BAND_COLORS</span></code></dt>
<dd>
<div class="desc"><p>Band colors.</p>
<p>Each band will be displayed in its own color.</p></div>
</dd>
<dt id="pipeline.parameters.COLORS"><code class="name">var <span class="ident">COLORS</span></code></dt>
<dd>
<div class="desc"><p>Named colors.</p></div>
</dd>
<dt id="pipeline.parameters.SETTINGS"><code class="name">var <span class="ident">SETTINGS</span></code></dt>
<dd>
<div class="desc"><p>Customizable settings.</p>
<p>These are the settings that can be customized
by calling the <code><a title="pipeline.parameters.Config" href="#pipeline.parameters.Config">Config</a></code> constructor and the
<code><a title="pipeline.parameters.Config.configure" href="#pipeline.parameters.Config.configure">Config.configure()</a></code> method.</p>
<p>The default values can be inspected by expanding the source code.</p>
<dl>
<dt>inDir</dt>
<dd>name of the subdirectory with page scans</dd>
<dt>outDir</dt>
<dd>name of the subdirectory with the final results of the pipeline</dd>
<dt>interDir</dt>
<dd>name of the subdirectory with the intermediate results of the pipeline</dd>
<dt>marksDir</dt>
<dd>name of the subdirectory with the marks and dividers</dd>
<dt>skewBorder</dt>
<dd>the
width of the page
margins that will be whitened in order to
suppress the sharp black triangles introduces by skewing the page</dd>
<dt>blurX</dt>
<dd>the amount of blur in the X-direction.
Blurring is needed to get betterskewing and histograms</dd>
<dt>blurY</dt>
<dd>
<p>the amount of blur in the X-direction.
Blurring is needed to get betterskewing and histograms.</p>
<div class="admonition caution">
<p class="admonition-title">Amount of Y-blurring</p>
<p>Too much vertical blurring will cause the disappearance of horizontal
bars from the histogram. Footnote
bars will go undetected.</p>
<p>Too little vertical blurring will result in ragged histograms,
from which it is difficult to get vertical line boundaries.</p>
</div>
</dd>
<dt>marginThresholdX, marginThresholdY</dt>
<dd>
<p>used when interpreting histograms.</p>
<p><strong>Vertical lines</strong>:</p>
<p>The histogram for vertical lines will be chunked into groups,
and only the biggest group will be retained.</p>
<p>More precisely, values in the histogram for vertical lines that are below
marginThresholdX will be considered 0. After that, the histogram points
will be grouped into consecutive chunks with nonzero values.
The biggest such group will have the vertical lines that contain the page material.
All other vertical lines will be whitened.</p>
<p><strong>Horizontal lines</strong>:</p>
<p>When histograms for horizontal lines cross marginThresholdY,
it will taken as an
indication that a line boundary (upper or lower) has been reached.</p>
<div class="admonition hint">
<p class="admonition-title">Ragged histograms</p>
<p>Histograms may be a bit ragged.</p>
<p>When a histogram dives below the threshold, but jumps above it
later, without having become zero in the meantime, the last such point
will be taken as a lower boundary.</p>
<p>When a histogram jumps above the threshold, but dives below it
later, without touching zero, and then jumps above the threshold
again, the latter point will <em>not</em> become the upper boundary.</p>
</div>
</dd>
<dt>accuracy</dt>
<dd>When marks are searched for in the page, we get the result in the form
of a grayscale page where the value in each point reflects how much
the page in that area resembles the mark.
Only hits above the value of <em>accuracy</em> will be considered.</dd>
<dt>connectBorder</dt>
<dd>When marks are found, each hit will be inspected:
is the ink in the hit connected to the ink outside the hit?
This will be measured in an inner and outer border of the page,
whose thickness is given by this parameter.</dd>
<dt>connectThreshold</dt>
<dd>After computing inner and outer borders,
they will be inverted, so that black has the maximum
value. Then the inside and outside borders are multiplied pixel wise,
so that places where they are both black get very high values.
All places where this product is higher than the value of <em>connectThreshold</em>
are retained for further calculation.</dd>
<dt>connectRatio</dt>
<dd>After computing the places where inner and outer borders contain
joint ink, the ratio of such places with respect to the total border size
is calculated. If that ratio is greater than <em>connectRatio</em>,
the hit counts as connected to its surroundings.
We have not found a true instance of the mark, and the mark will not be cleaned.</dd>
<dt>boxBorder</dt>
<dd>The hits after searching for marks will be indicated on the <code>boxed</code> stage
of the page by means of a small coloured border around each hit.
The width of this border is <em>boxBorder</em>.</dd>
<dt>maxHits</dt>
<dd>When searching for marks, there are usually multiple hits: the place where
the mark occurs, and some places very nearby.
The cleaning algorithm will cluster nearby hits and pick the best
hit per cluster.
But if the number of hits is very large, it is a sign that the mark
is not searched with the right accuracy, and clustering will be
prevented. It would become very expensive, and useless anyway.
A warning will be issued in such cases.</dd>
<dt>bandMain</dt>
<dd>
<p>Offsets for the <code>main</code> band. Given as <code>(top, bottom)</code>, with
<code>top</code> and <code>bottom</code> positive or negative integers.</p>
<p>This band covers most of the ink in a line.</p>
<p>The <code>main</code> band is computed from the histogram after which the
height of the top and bottom boundaries are adjusted relative to the
values obtained by the histogram algorithm.</p>
<p>You can adjust these values: higher values move the boundaries down,
lower values move them up.</p>
</dd>
<dt>bandInter</dt>
<dd>
<p>Offsets for the <code>inter</code> band.</p>
<p>This band covers most of the white between two lines.</p>
<p>The <code>inter</code> band is computed from the histogram.</p>
</dd>
<dt>bandBroad</dt>
<dd>
<p>Offsets for the <code>broad</code> band.</p>
<p>This band s like <code>main</code> but covers even more ink in a line.</p>
</dd>
<dt>bandMid</dt>
<dd>
<p>Offsets for the <code>mid</code> band.</p>
<p>This band s like <code>main</code> but covers the densest part in a line.</p>
</dd>
<dt>bandHigh</dt>
<dd>
<p>Offsets for the <code>high</code> band.</p>
<p>This band s like <code>inter</code> but covers the upper part of the letters and the white
space above it.</p>
</dd>
<dt>bandLow</dt>
<dd>
<p>Offsets for the <code>low</code> band.</p>
<p>This band s like <code>inter</code> but covers the lower part of the letters and the white
space below it.</p>
</dd>
</dl></div>
</dd>
<dt id="pipeline.parameters.STAGES"><code class="name">var <span class="ident">STAGES</span></code></dt>
<dd>
<div class="desc"><p>Stages in page processing.</p>
<p>When we process a scanned page,
we produce named intermediate stages,
in this order.</p>
<p>The <code>&hellip;Data</code> stages are tab separated files with unicode data.</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pipeline.parameters.Config"><code class="flex name class">
<span>class <span class="ident">Config</span></span>
<span>(</span><span>tm, **params)</span>
</code></dt>
<dd>
<div class="desc"><p>Settings manager.</p>
<p>It will expose all settings as attributes to the rest
of the application.</p>
<p>It has methods to collect modified settings from the
user and apply them.</p>
<p>The default settings are kept as a separate copy that
will not be changed in any way.</p>
<p>User modifications act on the current settings,
which have been obtained by deep-copying the defaults.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>tm</code></strong> :&ensp;<code>object</code></dt>
<dd>Can display timed info/error messages to the display</dd>
<dt><strong><code>params</code></strong> :&ensp;<code>dict</code></dt>
<dd>key-value pairs that act as updates for the settings.
If a value is <code>None</code>, the original value will be reinstated.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/annotation/text-fabric/blob/190a380fa2c5889b9540f63bfd09e453e11bfcc6/pipeline/parameters.py#L239-L350" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Config:
    def __init__(self, tm, **params):
        &#34;&#34;&#34;Settings manager.

        It will expose all settings as attributes to the rest
        of the application.

        It has methods to collect modified settings from the
        user and apply them.

        The default settings are kept as a separate copy that
        will not be changed in any way.

        User modifications act on the current settings,
        which have been obtained by deep-copying the defaults.

        Parameters
        ----------
        tm: object
            Can display timed info/error messages to the display
        params: dict
            key-value pairs that act as updates for the settings.
            If a value is `None`, the original value will be reinstated.
        &#34;&#34;&#34;

        self.tm = tm

        # colors are fixed
        for (k, v) in COLORS.items():
            setattr(self, k, v)

        # bands
        setattr(self, &#34;colorBand&#34;, BAND_COLORS)

        # stages
        setattr(self, &#34;stageOrder&#34;, tuple(STAGES))
        setattr(self, &#34;stages&#34;, STAGES)

        # settings
        self.settings = deepcopy(SETTINGS)

        # configure
        self.configure(reset=False, **params)

    def configure(self, reset=False, **params):
        &#34;&#34;&#34;Updates current settings based on new values.

        User modifications act on the current settings,
        which have been obtained by deep-copying the defaults.

        Parameters
        ----------
        reset: boolean, optional `False`
            If `True`, a fresh deep copy of the defaults will be made
            and that will be the basis for the new current settings.
        params: dict
            key-value pairs that act as updates for the settings.
            If a value is `None`, the original value will be reinstated.
        &#34;&#34;&#34;

        error = self.tm.error

        if reset:
            self.settings = deepcopy(SETTINGS)

        settings = self.settings

        for (k, v) in params.items():
            if k in SETTINGS:
                settings[k] = SETTINGS[k] if v is None else v
            else:
                error(f&#34;Unknown setting: {k}&#34;)

        # band offsets

        offsetBand = {}
        settings[&#34;offsetBand&#34;] = offsetBand

        for band in self.colorBand:
            bandOff = f&#34;band{band[0].upper()}{band[1:]}&#34;
            offsetBand[band] = settings[bandOff]

        # deliver as attributes

        for (k, v) in settings.items():
            if not k.startswith(&#34;band&#34;):
                setattr(self, k, v)

    def show(self, params=None):
        &#34;&#34;&#34;Display current settings.

        Parameters
        ----------
        params: str, optional `None`
            If `None`, all settings will be displayed.
            Else it should be a comma-separated string of legal
            parameter names whose values are to be displayed.
        &#34;&#34;&#34;
        tm = self.tm
        error = tm.error
        info = tm.info

        settings = self.settings

        params = sorted(set(params.split(&#39;,&#39;)) if params else settings)

        for k in params:
            if k in settings and k not in SETTINGS:
                continue
            if k not in SETTINGS:
                error(f&#34;No such setting: {k}&#34;, tm=False)
            info(f&#34;{k:&lt;20} = {settings[k]}&#34;, tm=False)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="pipeline.parameters.Config.configure"><code class="name flex">
<span>def <span class="ident">configure</span></span>(<span>self, reset=False, **params)</span>
</code></dt>
<dd>
<div class="desc"><p>Updates current settings based on new values.</p>
<p>User modifications act on the current settings,
which have been obtained by deep-copying the defaults.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>reset</code></strong> :&ensp;<code>boolean</code>, optional <code>False</code></dt>
<dd>If <code>True</code>, a fresh deep copy of the defaults will be made
and that will be the basis for the new current settings.</dd>
<dt><strong><code>params</code></strong> :&ensp;<code>dict</code></dt>
<dd>key-value pairs that act as updates for the settings.
If a value is <code>None</code>, the original value will be reinstated.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/annotation/text-fabric/blob/190a380fa2c5889b9540f63bfd09e453e11bfcc6/pipeline/parameters.py#L283-L325" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def configure(self, reset=False, **params):
    &#34;&#34;&#34;Updates current settings based on new values.

    User modifications act on the current settings,
    which have been obtained by deep-copying the defaults.

    Parameters
    ----------
    reset: boolean, optional `False`
        If `True`, a fresh deep copy of the defaults will be made
        and that will be the basis for the new current settings.
    params: dict
        key-value pairs that act as updates for the settings.
        If a value is `None`, the original value will be reinstated.
    &#34;&#34;&#34;

    error = self.tm.error

    if reset:
        self.settings = deepcopy(SETTINGS)

    settings = self.settings

    for (k, v) in params.items():
        if k in SETTINGS:
            settings[k] = SETTINGS[k] if v is None else v
        else:
            error(f&#34;Unknown setting: {k}&#34;)

    # band offsets

    offsetBand = {}
    settings[&#34;offsetBand&#34;] = offsetBand

    for band in self.colorBand:
        bandOff = f&#34;band{band[0].upper()}{band[1:]}&#34;
        offsetBand[band] = settings[bandOff]

    # deliver as attributes

    for (k, v) in settings.items():
        if not k.startswith(&#34;band&#34;):
            setattr(self, k, v)</code></pre>
</details>
</dd>
<dt id="pipeline.parameters.Config.show"><code class="name flex">
<span>def <span class="ident">show</span></span>(<span>self, params=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Display current settings.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>params</code></strong> :&ensp;<code>str</code>, optional <code>None</code></dt>
<dd>If <code>None</code>, all settings will be displayed.
Else it should be a comma-separated string of legal
parameter names whose values are to be displayed.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/annotation/text-fabric/blob/190a380fa2c5889b9540f63bfd09e453e11bfcc6/pipeline/parameters.py#L327-L350" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def show(self, params=None):
    &#34;&#34;&#34;Display current settings.

    Parameters
    ----------
    params: str, optional `None`
        If `None`, all settings will be displayed.
        Else it should be a comma-separated string of legal
        parameter names whose values are to be displayed.
    &#34;&#34;&#34;
    tm = self.tm
    error = tm.error
    info = tm.info

    settings = self.settings

    params = sorted(set(params.split(&#39;,&#39;)) if params else settings)

    for k in params:
        if k in settings and k not in SETTINGS:
            continue
        if k not in SETTINGS:
            error(f&#34;No such setting: {k}&#34;, tm=False)
        info(f&#34;{k:&lt;20} = {settings[k]}&#34;, tm=False)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<p><a href="https://github.com/among" title="among Digital Manuscripts on GitHub"><img src="/fusus/images/fusus-small.png"></a></p>
<p><a href="/fusus/index.html">fusus home</a> - <a href="/fusus/cheatsheet.html">cheat sheet</a></p>
<div class="gcse-search" style="height: 70px"
data-as_oq="inurl:github.com/annotation site:annotation.github.io site:www.annotation.nl"
data-gaCategoryParameter="pipeline.parameters">
</div>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pipeline" href="index.html">pipeline</a></code></li>
</ul>
</li>
<li><h3><a href="#header-variables">Global variables</a></h3>
<ul class="">
<li><code><a title="pipeline.parameters.BAND_COLORS" href="#pipeline.parameters.BAND_COLORS">BAND_COLORS</a></code></li>
<li><code><a title="pipeline.parameters.COLORS" href="#pipeline.parameters.COLORS">COLORS</a></code></li>
<li><code><a title="pipeline.parameters.SETTINGS" href="#pipeline.parameters.SETTINGS">SETTINGS</a></code></li>
<li><code><a title="pipeline.parameters.STAGES" href="#pipeline.parameters.STAGES">STAGES</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pipeline.parameters.Config" href="#pipeline.parameters.Config">Config</a></code></h4>
<ul class="">
<li><code><a title="pipeline.parameters.Config.configure" href="#pipeline.parameters.Config.configure">configure</a></code></li>
<li><code><a title="pipeline.parameters.Config.show" href="#pipeline.parameters.Config.show">show</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<a href="https://www.annotation.nl">Dirk Roorda</a>
<a href="https://www.dans.knaw.nl"><img alt="DANS" src="/text-fabric/images/DANS-logo.png" width=200></a>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.1</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>